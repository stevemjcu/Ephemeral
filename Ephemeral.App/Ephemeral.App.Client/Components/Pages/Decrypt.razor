@page "/decrypt/{id}"
@using System.Text
@inject EphemeralApi Api
@inject NavigationManager NavigationManager

<PageTitle>Decrypt Secret</PageTitle>

<Submission Label="Decrypt the secret to view its contents." Value=... Action=Action />

@code {
	[Parameter] public required string Id { get; set; }

	private string Secret { get; set; } = string.Empty;

	protected override async Task OnInitializedAsync()
	{
		var data = await Api.SecretsGETAsync(new(Id));
		var key = Convert.FromBase64String(new Uri(NavigationManager.Uri).Fragment);

		Secret = Encoding.UTF8.GetString(Crypto.Decrypt(data, key));
	}

#pragma warning disable 1998
	private async Task<string> Action(string _) => Secret;
#pragma warning restore 1998
}